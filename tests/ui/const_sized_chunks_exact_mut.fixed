#![warn(clippy::const_sized_chunks_exact_mut)]
#![feature(array_chunks)]
#![allow(unused_variables)]
#![allow(dead_code)]

fn test_binding() {
    let mut numbers = [0, 1, 2, 3, 4];

    #[allow(clippy::needless_borrow)]
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    #[allow(unused_mut)]
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }
}

fn test_slice_like() {
    let mut numbers = [2; 5];
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    let mut numbers = [0, 1, 2, 3, 4];
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    let mut numbers = &mut [0, 1, 2, 3, 4];
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    let mut numbers = &mut &mut [0, 1, 2, 3, 4];
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    let mut numbers = &mut &mut &mut [0, 1, 2, 3, 4];
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    let mut numbers = Vec::from_iter(0..5);
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    let mut numbers = &mut Vec::from_iter(0..5);
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }
}

fn test_const_eval() {
    const N: usize = 2;

    let mut numbers = [2; 5];
    for [a, b] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    for [a, b, c] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }
}

fn test_chunk_size() {
    let mut numbers = Vec::from_iter(0..5);
    for chunk in numbers.chunks_exact_mut(0) {}

    for [a] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    for [a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z] in numbers.array_chunks_mut() {
        //~^ const_sized_chunks_exact_mut
    }

    for chunk in numbers.chunks_exact_mut(27) {}
}

fn main() {}
